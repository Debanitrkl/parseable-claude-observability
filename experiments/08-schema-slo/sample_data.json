{
  "experiment_id": "08-schema-slo",
  "schema_definition": {
    "description": "Parseable static schema for payment service log stream",
    "fields": [
      { "name": "timestamp", "type": "string", "format": "ISO 8601", "description": "Application-level event timestamp" },
      { "name": "level", "type": "string", "enum": ["DEBUG", "INFO", "WARN", "ERROR", "FATAL"], "description": "Log severity level" },
      { "name": "service", "type": "string", "description": "Service name (payment-service)" },
      { "name": "version", "type": "string", "description": "Service version" },
      { "name": "environment", "type": "string", "description": "Deployment environment" },
      { "name": "host", "type": "string", "description": "Hostname or pod name" },
      { "name": "trace_id", "type": "string", "description": "W3C trace ID for distributed tracing correlation" },
      { "name": "span_id", "type": "string", "description": "W3C span ID" },
      { "name": "correlation_id", "type": "string", "description": "Business-level request correlation ID" },
      { "name": "operation", "type": "string", "enum": ["charge", "refund", "payout"], "description": "Payment operation type" },
      { "name": "status", "type": "string", "enum": ["success", "failure", "timeout", "invalid"], "description": "Operation outcome" },
      { "name": "duration_ms", "type": "float", "description": "Operation duration in milliseconds" },
      { "name": "amount_cents", "type": "integer", "description": "Transaction amount in cents" },
      { "name": "currency", "type": "string", "description": "ISO 4217 currency code" },
      { "name": "customer_id_hash", "type": "string", "description": "SHA-256 hash of customer email" },
      { "name": "card_last_four", "type": "string", "description": "Last four digits of card number" },
      { "name": "card_brand", "type": "string", "description": "Card brand (visa, mastercard, etc.)" },
      { "name": "gateway", "type": "string", "description": "Payment gateway used (stripe, adyen, etc.)" },
      { "name": "gateway_response_code", "type": "string", "description": "Response code from payment gateway" },
      { "name": "error_code", "type": "string", "description": "Internal error code if applicable" },
      { "name": "error_message", "type": "string", "description": "Error description if applicable" },
      { "name": "idempotency_key", "type": "string", "description": "Idempotency key for deduplication" },
      { "name": "message", "type": "string", "description": "Human-readable log message" }
    ]
  },
  "example_events": [
    {
      "timestamp": "2025-01-25T14:30:22.451Z",
      "level": "INFO",
      "service": "payment-service",
      "version": "2.4.1",
      "environment": "production",
      "host": "payment-service-7b4d6f8c9d-x2k4n",
      "trace_id": "4bf92f3577b34da6a3ce929d0e0e4736",
      "span_id": "00f067aa0ba902b7",
      "correlation_id": "pay-req-a1b2c3d4",
      "operation": "charge",
      "status": "success",
      "duration_ms": 234.5,
      "amount_cents": 4999,
      "currency": "USD",
      "customer_id_hash": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",
      "card_last_four": "4242",
      "card_brand": "visa",
      "gateway": "stripe",
      "gateway_response_code": "approved",
      "error_code": null,
      "error_message": null,
      "idempotency_key": "idem-ord-12345-charge-001",
      "message": "Charge completed successfully"
    },
    {
      "timestamp": "2025-01-25T14:30:25.892Z",
      "level": "ERROR",
      "service": "payment-service",
      "version": "2.4.1",
      "environment": "production",
      "host": "payment-service-7b4d6f8c9d-x2k4n",
      "trace_id": "5cf83e4688c45eb7b4df030a1f1f5847",
      "span_id": "11f178bb1cb013c8",
      "correlation_id": "pay-req-e5f6g7h8",
      "operation": "charge",
      "status": "failure",
      "duration_ms": 1523.8,
      "amount_cents": 15000,
      "currency": "EUR",
      "customer_id_hash": "a7ffc6f8bf1ed76651c14756a061d662f580ff4de43b49fa82d80a4b80f8434a",
      "card_last_four": "1234",
      "card_brand": "mastercard",
      "gateway": "stripe",
      "gateway_response_code": "card_declined",
      "error_code": "GATEWAY_DECLINE",
      "error_message": "Card declined by issuing bank",
      "idempotency_key": "idem-ord-67890-charge-001",
      "message": "Charge failed: card declined by issuing bank"
    },
    {
      "timestamp": "2025-01-25T14:31:01.113Z",
      "level": "INFO",
      "service": "payment-service",
      "version": "2.4.1",
      "environment": "production",
      "host": "payment-service-7b4d6f8c9d-x2k4n",
      "trace_id": "6da94f5799d56fc8c5e0141b2g2g6958",
      "span_id": "22g289cc2dc124d9",
      "correlation_id": "pay-req-i9j0k1l2",
      "operation": "refund",
      "status": "success",
      "duration_ms": 312.1,
      "amount_cents": 2500,
      "currency": "USD",
      "customer_id_hash": "d4735e3a265e16eee03f59718b9b5d03019c07d8b6c51f90da3a666eec13ab35",
      "card_last_four": "5678",
      "card_brand": "visa",
      "gateway": "stripe",
      "gateway_response_code": "approved",
      "error_code": null,
      "error_message": null,
      "idempotency_key": "idem-ord-11111-refund-001",
      "message": "Refund processed successfully"
    },
    {
      "timestamp": "2025-01-25T14:31:15.667Z",
      "level": "ERROR",
      "service": "payment-service",
      "version": "2.4.1",
      "environment": "production",
      "host": "payment-service-7b4d6f8c9d-x2k4n",
      "trace_id": "7eb05g6800e67gd9d6f1252c3h3h7069",
      "span_id": "33h390dd3ed235e0",
      "correlation_id": "pay-req-m3n4o5p6",
      "operation": "charge",
      "status": "timeout",
      "duration_ms": 5002.3,
      "amount_cents": 8750,
      "currency": "USD",
      "customer_id_hash": "ef2d127de37b942baad06145e54b0c619a1f22327b2ebbcfbec78f5564afe39d",
      "card_last_four": "9012",
      "card_brand": "amex",
      "gateway": "adyen",
      "gateway_response_code": null,
      "error_code": "GATEWAY_TIMEOUT",
      "error_message": "Gateway response timeout after 5000ms",
      "idempotency_key": "idem-ord-22222-charge-001",
      "message": "Charge failed: gateway timeout"
    }
  ],
  "slo_definitions": {
    "availability": {
      "name": "Payment Availability",
      "description": "Proportion of payment requests that return a non-error response",
      "target": 0.9995,
      "sli": "count(status IN ['success', 'invalid']) / count(all requests)",
      "window": "30 days rolling",
      "error_budget_minutes_per_month": 21.6
    },
    "latency": {
      "name": "Payment Latency (Charge)",
      "description": "99th percentile latency for charge operations",
      "target_ms": 500,
      "sli": "p99(duration_ms) WHERE operation = 'charge'",
      "window": "30 days rolling"
    }
  }
}
